import{Client as e,createRequest as u}from"@urql/core";export*from"@urql/core";import{provide as n,getCurrentInstance as t,inject as r,reactive as a,ref as o,isRef as i,watchEffect as v,onBeforeUnmount as l,onMounted as c}from"vue";import{makeSubject as s,concat as f,filter as p,map as d,fromValue as x,share as y,onPush as h,onEnd as b,onStart as q,publish as m,switchAll as P,toPromise as g,take as k}from"wonka";function w(){return(w=Object.assign||function(e){for(var u=1;u<arguments.length;u++){var n=arguments[u];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function Q(u){var t=u instanceof e?u:new e(u);return n("$urql",t),t}function S(u,n){var t=n instanceof e?n:new e(n);u.provide("$urql",t)}function O(){return r("$urql")}var $={flush:"pre"};function j(e){return M(e)}function M(e,n,t){void 0===n&&(n=O()),void 0===t&&(t=[]);var r=a(e),l=o(),c=o(!1),Q=o(!1),S=o(),j=o(),M=o(),z=i(e.pause)?e.pause:o(!!e.pause),A=o(u(r.query,r.variables)),B=o(null),C=o(null);t.push(v((function(){var e=u(r.query,r.variables);A.value.key!==e.key&&(A.value=e)}),$));var D={data:l,stale:c,error:S,operation:j,extensions:M,fetching:Q,isPaused:z,executeQuery:function(e){return C.value(n.executeQuery(A.value,w({},{requestPolicy:r.requestPolicy},r.context,e))),F},pause:function(){z.value=!0},resume:function(){z.value=!1}},E=function(){return D};t.push(v((function(e){var u=s();B.value=function(e){var u;return f([p((function(e){return void 0!==e}))(d((function(){return u}))(x(u))),y(h((function(e){u=e}))(e))])}(u.source),C.value=function(e){var n=!1;function t(){n||(n=!0,Q.value=!0,c.value=!1)}var r=b((function(){Q.value=!1,c.value=!1}))(e?y(h((function(e){t(),l.value=e.data,c.value=!!e.stale,Q.value=!1,S.value=e.error,j.value=e.operation,M.value=e.extensions}))(q(t)(e))):x(void 0));u.next(r)},e(m(d(E)(P(B.value))).unsubscribe)}),{flush:"sync"})),t.push(v((function(){C.value(z.value?void 0:n.executeQuery(A.value,w({},{requestPolicy:r.requestPolicy},r.context)))}),$));var F=w({},D,{then:function(e,u){return(l.value?Promise.resolve(D):g(k(1)(d(E)(P(B.value))))).then(e,u)}});return F}function z(e){return A(e)}function A(e,u){void 0===u&&(u=O());var n=o(),t=o(!1),r=o(!1),a=o(),i=o(),v=o();return{data:n,stale:t,fetching:r,error:a,operation:i,extensions:v,executeMutation:function(o,l){return r.value=!0,u.mutation(e,o,l).toPromise().then((function(e){return n.value=e.data,t.value=!!e.stale,r.value=!1,a.value=e.error,i.value=e.operation,v.value=e.extensions,e}))}}}var B={flush:"pre"};function C(e,u){return D(e,u)}function D(e,n,t,r){void 0===t&&(t=O()),void 0===r&&(r=[]);var l=a(e),c=o(),s=o(!1),f=o(!1),p=o(),d=o(),x=o(),P=o(n),g=i(e.pause)?e.pause:o(!!e.pause),k=o(u(l.query,l.variables)),Q=o();r.push(v((function(){var e=u(l.query,l.variables);k.value.key!==e.key&&(k.value=e)}),B)),r.push(v((function(){Q.value=g.value?void 0:y(t.executeSubscription(k.value,w({},l.context)))}),B)),r.push(v((function(e){Q.value&&e(m(h((function(e){f.value=!0,c.value=void 0!==e.data&&"function"==typeof P.value?P.value(c.value,e.data):e.data,p.value=e.error,x.value=e.extensions,s.value=!!e.stale,d.value=e.operation}))(b((function(){f.value=!1}))(q((function(){f.value=!0}))(Q.value)))).unsubscribe)}),B));var S={data:c,stale:s,error:p,operation:d,extensions:x,fetching:f,isPaused:g,executeSubscription:function(e){return Q.value=y(t.executeSubscription(k.value,w({},l.context,e))),S},pause:function(){g.value=!0},resume:function(){g.value=!1}};return S}function E(){var e=O(),u=[];return l((function(){for(var e;e=u.shift();)e()})),{client:e,useQuery:function(n){return M(n,e,u)},useSubscription:function(n,t){return D(n,t,e,u)},useMutation:function(u){return A(u,e)}}}export default S;export{S as install,Q as provideClient,E as useClientHandle,z as useMutation,j as useQuery,C as useSubscription};
//# sourceMappingURL=urql-vue.min.mjs.map
